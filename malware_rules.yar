rule PotentialBackdoor {
  meta:
    description = "Detects code that checks for a 'backdoor_access' variable"
    author = "ritanshu"
    severity = 2
  strings:
    $backdoor_var = "backdoor_access" ascii
    $secret_func_call = "secret_function" ascii
  condition:
    all of them
}

rule SuspiciousStrings {
  meta:
    description = "Detects files containing common suspicious API calls or strings and the EICAR test string"
    author = "ritanshu"
  strings:
    $a = "CreateRemoteThread" ascii
    $b = "VirtualAlloc" ascii
    $c = "Ransomware" ascii wide
    $d = "X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*" ascii
    $re1 = /user(id)?\s*=\s*[A-Za-z0-9_]+/
    $re2 = /error\s+\d{3}/
    $string7 = "%PDF-1.6" 
    $magic = { 50 4b 03 04 ( 14 | 0a ) 00 } 
  condition:
    (uint16(0) == 0x5A4D and any of ($a, $b, $c, $magic, $string7, $re1, $re2)) or $d 
}
